# Running

```shell
docker-compose build

docker-compose up {dotnet|fastify}
```

> Important to use `docker-compose` and not `docker compose`.
> In my case `docker compose` was ignoring cpu limits messing up the benchmarks
> Your mileage may vary

# Checking stats

You can check in real time how much memory and cpu is consumed by the containers

```shell
docker stats $( docker ps --format '{{ .Names }}' )
```

# Benchmarking

```shell
autocannon -c 100 -d 40 -p 10 localhost:5105
```

# Results

## Dotnet

```
┌─────────┬───────┬───────┬───────┬───────┬──────────┬──────────┬────────┐
│ Stat    │ 2.5%  │ 50%   │ 97.5% │ 99%   │ Avg      │ Stdev    │ Max    │
├─────────┼───────┼───────┼───────┼───────┼──────────┼──────────┼────────┤
│ Latency │ 10 ms │ 21 ms │ 86 ms │ 91 ms │ 38.23 ms │ 26.86 ms │ 125 ms │
└─────────┴───────┴───────┴───────┴───────┴──────────┴──────────┴────────┘
┌───────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┐
│ Stat      │ 1%      │ 2.5%    │ 50%     │ 97.5%   │ Avg     │ Stdev   │ Min     │
├───────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤
│ Req/Sec   │ 20607   │ 20607   │ 25791   │ 29407   │ 25818   │ 2266.37 │ 20605   │
├───────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤
│ Bytes/Sec │ 3.63 MB │ 3.63 MB │ 4.54 MB │ 5.18 MB │ 4.54 MB │ 399 kB  │ 3.63 MB │
└───────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┘
```

## Dotnet Old

By old I mean with controllers

```
┌─────────┬───────┬───────┬────────┬────────┬──────────┬──────────┬────────┐
│ Stat    │ 2.5%  │ 50%   │ 97.5%  │ 99%    │ Avg      │ Stdev    │ Max    │
├─────────┼───────┼───────┼────────┼────────┼──────────┼──────────┼────────┤
│ Latency │ 19 ms │ 80 ms │ 106 ms │ 111 ms │ 68.43 ms │ 28.93 ms │ 226 ms │
└─────────┴───────┴───────┴────────┴────────┴──────────┴──────────┴────────┘
┌───────────┬─────────┬─────────┬─────────┬────────┬─────────┬────────┬─────────┐
│ Stat      │ 1%      │ 2.5%    │ 50%     │ 97.5%  │ Avg     │ Stdev  │ Min     │
├───────────┼─────────┼─────────┼─────────┼────────┼─────────┼────────┼─────────┤
│ Req/Sec   │ 12015   │ 12015   │ 14495   │ 16447  │ 14497.4 │ 795.65 │ 12008   │
├───────────┼─────────┼─────────┼─────────┼────────┼─────────┼────────┼─────────┤
│ Bytes/Sec │ 2.11 MB │ 2.11 MB │ 2.55 MB │ 2.9 MB │ 2.55 MB │ 140 kB │ 2.11 MB │
└───────────┴─────────┴─────────┴─────────┴────────┴─────────┴────────┴─────────┘
```

## Fastify

```
┌─────────┬────────┬────────┬────────┬────────┬───────────┬──────────┬────────┐
│ Stat    │ 2.5%   │ 50%    │ 97.5%  │ 99%    │ Avg       │ Stdev    │ Max    │
├─────────┼────────┼────────┼────────┼────────┼───────────┼──────────┼────────┤
│ Latency │ 106 ms │ 126 ms │ 205 ms │ 277 ms │ 142.14 ms │ 33.76 ms │ 463 ms │
└─────────┴────────┴────────┴────────┴────────┴───────────┴──────────┴────────┘
┌───────────┬────────┬────────┬─────────┬─────────┬─────────┬────────┬────────┐
│ Stat      │ 1%     │ 2.5%   │ 50%     │ 97.5%   │ Avg     │ Stdev  │ Min    │
├───────────┼────────┼────────┼─────────┼─────────┼─────────┼────────┼────────┤
│ Req/Sec   │ 5211   │ 5211   │ 7091    │ 7607    │ 6997    │ 463.02 │ 5210   │
├───────────┼────────┼────────┼─────────┼─────────┼─────────┼────────┼────────┤
│ Bytes/Sec │ 980 kB │ 980 kB │ 1.33 MB │ 1.43 MB │ 1.32 MB │ 87 kB  │ 979 kB │
└───────────┴────────┴────────┴─────────┴─────────┴─────────┴────────┴────────┘
```

## Express

```
┌─────────┬────────┬────────┬────────┬────────┬───────────┬───────────┬─────────┐
│ Stat    │ 2.5%   │ 50%    │ 97.5%  │ 99%    │ Avg       │ Stdev     │ Max     │
├─────────┼────────┼────────┼────────┼────────┼───────────┼───────────┼─────────┤
│ Latency │ 314 ms │ 489 ms │ 585 ms │ 602 ms │ 493.22 ms │ 424.11 ms │ 9965 ms │
└─────────┴────────┴────────┴────────┴────────┴───────────┴───────────┴─────────┘
┌───────────┬────────┬────────┬────────┬────────┬─────────┬─────────┬────────┐
│ Stat      │ 1%     │ 2.5%   │ 50%    │ 97.5%  │ Avg     │ Stdev   │ Min    │
├───────────┼────────┼────────┼────────┼────────┼─────────┼─────────┼────────┤
│ Req/Sec   │ 1749   │ 1749   │ 1908   │ 2051   │ 1906.03 │ 89.74   │ 1749   │
├───────────┼────────┼────────┼────────┼────────┼─────────┼─────────┼────────┤
│ Bytes/Sec │ 441 kB │ 441 kB │ 481 kB │ 517 kB │ 480 kB  │ 22.6 kB │ 441 kB │
└───────────┴────────┴────────┴────────┴────────┴─────────┴─────────┴────────┘
```

## Gin

```
┌─────────┬──────┬───────┬────────┬────────┬──────────┬──────────┬─────────┐
│ Stat    │ 2.5% │ 50%   │ 97.5%  │ 99%    │ Avg      │ Stdev    │ Max     │
├─────────┼──────┼───────┼────────┼────────┼──────────┼──────────┼─────────┤
│ Latency │ 1 ms │ 96 ms │ 800 ms │ 994 ms │ 183.6 ms │ 226.2 ms │ 2014 ms │
└─────────┴──────┴───────┴────────┴────────┴──────────┴──────────┴─────────┘
┌───────────┬────────┬────────┬────────┬────────┬────────┬─────────┬────────┐
│ Stat      │ 1%     │ 2.5%   │ 50%    │ 97.5%  │ Avg    │ Stdev   │ Min    │
├───────────┼────────┼────────┼────────┼────────┼────────┼─────────┼────────┤
│ Req/Sec   │ 4823   │ 4823   │ 5379   │ 5935   │ 5411.4 │ 336.62  │ 4821   │
├───────────┼────────┼────────┼────────┼────────┼────────┼─────────┼────────┤
│ Bytes/Sec │ 675 kB │ 675 kB │ 753 kB │ 831 kB │ 758 kB │ 47.1 kB │ 675 kB │
└───────────┴────────┴────────┴────────┴────────┴────────┴─────────┴────────┘
```

## Rust rocket

```
┌─────────┬───────┬────────┬────────┬────────┬───────────┬──────────┬────────┐
│ Stat    │ 2.5%  │ 50%    │ 97.5%  │ 99%    │ Avg       │ Stdev    │ Max    │
├─────────┼───────┼────────┼────────┼────────┼───────────┼──────────┼────────┤
│ Latency │ 99 ms │ 128 ms │ 190 ms │ 201 ms │ 137.54 ms │ 28.49 ms │ 269 ms │
└─────────┴───────┴────────┴────────┴────────┴───────────┴──────────┴────────┘
┌───────────┬─────────┬─────────┬─────────┬─────────┬─────────┬────────┬─────────┐
│ Stat      │ 1%      │ 2.5%    │ 50%     │ 97.5%   │ Avg     │ Stdev  │ Min     │
├───────────┼─────────┼─────────┼─────────┼─────────┼─────────┼────────┼─────────┤
│ Req/Sec   │ 6499    │ 6499    │ 7179    │ 7955    │ 7233.65 │ 413.76 │ 6499    │
├───────────┼─────────┼─────────┼─────────┼─────────┼─────────┼────────┼─────────┤
│ Bytes/Sec │ 1.58 MB │ 1.58 MB │ 1.74 MB │ 1.93 MB │ 1.76 MB │ 101 kB │ 1.58 MB │
└───────────┴─────────┴─────────┴─────────┴─────────┴─────────┴────────┴─────────┘
```
